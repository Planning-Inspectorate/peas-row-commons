{% extends "views/layouts/main.njk" %}
{% from "views/layouts/components/search-bar.njk" import searchBar %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/notification-banner/macro.njk" import govukNotificationBanner %}

{% set title = reference + " - Manage a Case" %}

{% block pageTitle %}
    {{ title }}
{% endblock %}

{% block content %}
    {% if folderCreated %}
        {{ govukNotificationBanner({
            classes: "govuk-notification-banner__heading govuk-grid-column-two-thirds",
            text: "Folder created",
            type: "success",
            attributes: {
                "data-cy": "notification-banner-created"
            }
        }) }}
    {% endif %}
    {% if folderDeleted %}
        {{ govukNotificationBanner({
            classes: "govuk-notification-banner__heading govuk-grid-column-two-thirds",
            text: "Folder deleted",
            type: "success",
            attributes: {
                "data-cy": "notification-banner-deleted"
            }
        }) }}
    {% endif %}
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-full govuk-!-margin-bottom-3">
            <h2 class="govuk-caption-l" data-cy="page-caption">
                {{ reference }}
            </h2>
            <h1 class="govuk-heading-l" data-cy="page-heading">
                {{ pageHeading }}
            </h1>

            <form id="search-bar-form" method="GET" data-cy="search-form">
                {{ searchBar({
                    input: {
                        label: {
                            hidden: true
                        },
                        hint: {
                            text: "To find a document, search by file name"
                        },
                        classes: "govuk-input govuk-input--width-30",
                        attributes: {
                            "data-cy": "search-input"
                        }
                    },
                    button: {
                        text: "Search",
                        classes: "govuk-button",
                        attributes: {
                            "data-cy": "search-button"
                        }
                    },
                    formAction: currentUrl + "/search-results"
                }, searchValue) }}
            </form>

            {{ govukButton({
                text: "Create folder",
                classes: "govuk-button--secondary",
                href: currentUrl + "/create-folder",
                attributes: {
                    "data-cy": "create-folder-button"
                }
            }) }}

            <hr class="govuk-section-break govuk-section-break--s govuk-section-break--visible">
        </div>
    </div>
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-full">
            <div class="pins-link-menu" data-cy="folder-list">
                {% if folders|length == 0 %}
                    <p class="govuk-body" data-cy="no-folders-message">There are no folders in this case</p>
                {% else %}
                    {% for folder in folders %}
                        <a class="govuk-link govuk-heading-s" href="{{ currentUrl }}/{{ folder.id }}/{{ folder.encodedDisplayName }}" data-cy="folder-link-{{ folder.id }}">
                            {{ folder.displayName }}
                        </a>
                    {% endfor %}
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}